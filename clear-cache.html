<!DOCTYPE html>
<html>
<head>
    <title>Clear Aura Cache</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 10px; }
        button:hover { background: #0056b3; }
        .status { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Aura Cache Clearing Utility</h1>
    <p>Use this tool to clear all Aura-related data from your browser.</p>
    
    <button onclick="clearAllCache()">Clear All Cache</button>
    <button onclick="clearAuthOnly()">Clear Auth Only</button>
    <button onclick="showCacheStatus()">Show Cache Status</button>
    
    <div id="status"></div>
    
    <script>
        function showStatus(message, isError = false) {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="status ${isError ? 'error' : 'success'}">${message}</div>`;
        }
        
        function clearAllCache() {
            try {
                // Clear all Aura-related localStorage items
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.startsWith('aura_') || key.includes('firebase'))) {
                        keysToRemove.push(key);
                    }
                }
                
                keysToRemove.forEach(key => localStorage.removeItem(key));
                
                // Clear sessionStorage
                sessionStorage.clear();
                
                showStatus(`Cleared ${keysToRemove.length} items from localStorage and all sessionStorage`);
                
                // Redirect to main app after 2 seconds
                setTimeout(() => {
                    window.location.href = '/';
                }, 2000);
                
            } catch (error) {
                showStatus(`Error clearing cache: ${error.message}`, true);
            }
        }
        
        function clearAuthOnly() {
            try {
                const authKeys = ['aura_user_session', 'aura_users_cache', 'aura_posts_cache', 'aura_ads_cache'];
                let cleared = 0;
                
                authKeys.forEach(key => {
                    if (localStorage.getItem(key)) {
                        localStorage.removeItem(key);
                        cleared++;
                    }
                });
                
                showStatus(`Cleared ${cleared} authentication-related items`);
                
            } catch (error) {
                showStatus(`Error clearing auth: ${error.message}`, true);
            }
        }
        
        function showCacheStatus() {
            try {
                const auraItems = {};
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.startsWith('aura_') || key.includes('firebase'))) {
                        const value = localStorage.getItem(key);
                        auraItems[key] = value ? `${value.substring(0, 50)}...` : 'null';
                    }
                }
                
                const status = Object.keys(auraItems).length > 0 
                    ? `Found ${Object.keys(auraItems).length} Aura items:\n${JSON.stringify(auraItems, null, 2)}`
                    : 'No Aura items found in localStorage';
                    
                showStatus(`<pre>${status}</pre>`);
                
            } catch (error) {
                showStatus(`Error checking status: ${error.message}`, true);
            }
        }
    </script>
</body>
</html>
